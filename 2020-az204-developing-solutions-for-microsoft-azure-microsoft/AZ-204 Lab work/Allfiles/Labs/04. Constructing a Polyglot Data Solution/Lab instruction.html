<!DOCTYPE html>
<html lang="en-US">

<head>
    <meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
    <style id="stndz-style"></style>
    <meta name="viewport" content="width=device-width">
    <title>Module 04 (CSR): Constructing a Polyglot Data Solution</title>
</head>

<body class="childClient" data-new-gr-c-s-check-loaded="14.984.0" data-gr-ext-installed="">
    <div id="labClient" style="">
        <div id="tabs" role="main">
            <div id="instructionsTab" class="tab selected">
                <div id="instructionsContent" class="tabContent withFooter instructions withTaskProgress withNavigation"
                    aria-label="Lab Instructions">
                    <div class="zoomable" id="pages" style="transform: scale(1); width: 100%;">
                        <div class="page selected" id="page1">
                            <p></p>
                            <blockquote class="alert">
                                <p>TypeText must be input into <strong>Notepad</strong> and then copied into <strong>VS
                                        Code</strong> in order to maintain formatting.</p>
                            </blockquote>
                            <blockquote class="alert">
                                <p><strong>Do not</strong> click nested Typetext icons. Doing so will produce the wrong
                                    output.</p>
                                <!--ALERT-->
                                <p>
                                    <img src="./oftqjqbo.jpg" alt="oftqjqbo.jpg"></p>
                            </blockquote>
                            <blockquote class="alert">
                                <p>&amp;lt in a Typetext Box should be changed to &lt;</p>
                            </blockquote>
                            <blockquote class="alert">
                                <p>&amp;gt in a Typetext Box should be changed to &gt;</p>
                            </blockquote>
                            <include src="https://raw.githubusercontent.com/LODSContent/All-MOC/master/MOC/SkipCleanUp"
                                data-name="">
                                <blockquote class="knowledge">
                                    <p>At the end of this lab, you can skip the <strong>Clean Up</strong> exercise
                                        directing you to remove the resources from your Subscription or Resource
                                        Group(s). The clean up is handled automatically, after ending your lab.</p>
                                </blockquote>
                                <div class="moreKnowledge"><a
                                        href="https://labclient.labondemand.com/Instructions/616afa84-07a1-43b7-b8b8-093ff048c3d9?rc=10#"
                                        class="moreKnowledgeLink" style="display: none;">more...</a></div>
                            </include>
                            <include
                                src="https://raw.githubusercontent.com/MicrosoftLearning/AZ-204-DevelopingSolutionsforMicrosoftAzure/master/Instructions/Labs/AZ-204_04_lab.md"
                                data-name="">
                                <h1 id="lab-constructing-a-polyglot-data-solution">Lab: Constructing a polyglot data
                                    solution</h1>
                                <h1 id="student-lab-manual">Student lab manual</h1>
                                <h2 id="lab-scenario">Lab scenario</h2>
                                <p>You have been assigned the task of updating your company's existing retail web
                                    application to use more than one data service in Microsoft Azure. Your company's
                                    goal is to take advantage of the best data service for each application component.
                                    After conducting thorough research, you decide to migrate your inventory database
                                    from Azure SQL Database to Azure Cosmos DB.</p>
                                <h2 id="objectives">Objectives</h2>
                                <p>After you complete this lab, you will be able to:</p>
                                <ul>
                                    <li>
                                        <p>Create instances of various database services by using the Azure portal.</p>
                                    </li>
                                    <li>
                                        <p>Write C# code to connect to SQL Database.</p>
                                    </li>
                                    <li>
                                        <p>Write C# code to connect to Azure Cosmos DB.</p>
                                    </li>
                                </ul>
                                <h2 id="lab-setup">Lab setup</h2>
                                <ul>
                                    <li>Estimated time: <strong>45 minutes</strong></li>
                                </ul>
                                <h2 id="instructions">Instructions</h2>
                                <h3 id="before-you-start">Before you start</h3>
                                <h4 id="sign-in-to-the-lab-virtual-machine">Sign in to the lab virtual machine</h4>
                                <p>Ensure that you're signed in to your Windows 10 virtual machine by using the
                                    following credentials:</p>
                                <ul>
                                    <li>
                                        <p>Username: <strong>Admin</strong></p>
                                    </li>
                                    <li>
                                        <p>Password: <strong>Pa55w.rd</strong></p>
                                    </li>
                                </ul>
                                <h4 id="review-the-installed-applications">Review the installed applications</h4>
                                <p>Find the taskbar on your Windows 10 desktop. The taskbar contains the icons for the
                                    applications that you'll use in this lab:</p>
                                <ul>
                                    <li>
                                        <p>Microsoft Edge</p>
                                    </li>
                                    <li>
                                        <p>File Explorer</p>
                                    </li>
                                    <li>
                                        <p>Visual Studio Code</p>
                                    </li>
                                </ul>
                                <h3 id="exercise-1-creating-database-resources-in-azure">Exercise 1: Creating database
                                    resources in Azure</h3>
                                <h4 id="task-1-open-the-azure-portal">Task 1: Open the Azure portal</h4>
                                <ol class="taskList">
                                    <li class="task-list-item" id="taskIndex2">
                                        <p><label class="checkbox"><input type="checkbox"
                                                    aria-labelledby="taskIndex2"><span></span></label>Sign in to the
                                            Azure portal (<a
                                                href="https://portal.azure.com/">https://portal.azure.com</a>).</p>
                                    </li>
                                    <li class="task-list-item" id="taskIndex3">
                                        <p><label class="checkbox"><input type="checkbox"
                                                    aria-labelledby="taskIndex3"><span></span></label>If this is your
                                            first time signing in to the Azure portal, you'll notice a dialog box
                                            offering a tour of the portal. Select the <strong>Get Started</strong>
                                            button to skip the tour.</p>
                                    </li>
                                </ol>
                                <h4 id="task-2-create-an-azure-sql-database-server-resource">Task 2: Create an Azure SQL
                                    Database server resource</h4>
                                <ol class="taskList">
                                    <li class="task-list-item" id="taskIndex4">
                                        <p><label class="checkbox"><input type="checkbox"
                                                    aria-labelledby="taskIndex4"><span></span></label>Create a new
                                            <strong>Azure SQL Database server (logical server)</strong> resource with
                                            the following details:</p>
                                        <ul>
                                            <li>
                                                <p>Server name: <strong>polysqlsrvr*[yourname]*</strong></p>
                                            </li>
                                            <li>
                                                <p>New resource group: <strong>PolyglotData</strong></p>
                                            </li>
                                            <li>
                                                <p>Server admin login: <strong>testuser</strong></p>
                                            </li>
                                            <li>
                                                <p>Password: <strong>TestPa55w.rd</strong></p>
                                            </li>
                                            <li>
                                                <p>Location: <strong>(US) East US</strong></p>
                                            </li>
                                            <li>
                                                <p>Allow Azure services to access server: <strong>Yes</strong></p>
                                            </li>
                                        </ul>
                                        <blockquote>
                                            <p><strong>Note</strong>: At this point in the lab, we are only creating the
                                                Azure SQL logical server. We will create the Azure SQL database instance
                                                later in the lab.</p>
                                        </blockquote>
                                        <blockquote>
                                            <p><strong>Note</strong>: Wait for Azure to finish creating the SQL server
                                                instance before you move forward with the lab. You'll receive a
                                                notification when the SQL server is created.</p>
                                        </blockquote>
                                    </li>
                                </ol>
                                <h4 id="task-3-create-an-azure-cosmos-db-account-resource">Task 3: Create an Azure
                                    Cosmos DB account resource</h4>
                                <ol class="taskList">
                                    <li class="task-list-item" id="taskIndex5">
                                        <p><label class="checkbox"><input type="checkbox"
                                                    aria-labelledby="taskIndex5"><span></span></label>Create a new
                                            <strong>Azure Cosmos DB</strong> instance with the following details:</p>
                                        <ul>
                                            <li>
                                                <p>Account name: <strong>polycosmos*[yourname]*</strong></p>
                                            </li>
                                            <li>
                                                <p>Existing resource group: <strong>PolyglotData</strong></p>
                                            </li>
                                            <li>
                                                <p>API: <strong>Core (SQL)</strong></p>
                                            </li>
                                            <li>
                                                <p>Notebooks (Preview): <strong>Off</strong></p>
                                            </li>
                                            <li>
                                                <p>Apply Free Tier Discount: <strong>Do Not Apply</strong></p>
                                            </li>
                                            <li>
                                                <p>Location: <strong>(US) East US</strong></p>
                                            </li>
                                            <li>
                                                <p>Account Type <strong>Non-Production</strong></p>
                                            </li>
                                            <li>
                                                <p>Multi-region writes: <strong>Disable</strong></p>
                                            </li>
                                        </ul>
                                        <blockquote>
                                            <p><strong>Note</strong>: Wait for Azure to finish creating the Azure Cosmos
                                                DB account before you move forward with the lab. You'll receive a
                                                notification when the Azure Cosmos DB account is created.</p>
                                        </blockquote>
                                    </li>
                                    <li class="task-list-item" id="taskIndex6">
                                        <p><label class="checkbox"><input type="checkbox"
                                                    aria-labelledby="taskIndex6"><span></span></label>Go to the blade
                                            for your newly created Azure Cosmos DB account resource, and then open the
                                            Keys pane.</p>
                                    </li>
                                    <li class="task-list-item" id="taskIndex7">
                                        <p><label class="checkbox"><input type="checkbox"
                                                    aria-labelledby="taskIndex7"><span></span></label>In the Keys pane,
                                            record the value of the <strong>PRIMARY CONNECTION STRING</strong> text box.
                                        </p>
                                        <blockquote>
                                            <p><strong>Note</strong>: You'll use these values later in this lab.</p>
                                        </blockquote>
                                    </li>
                                </ol>
                                <h4 id="task-4-create-an-azure-storage-account-resource">Task 4: Create an Azure Storage
                                    account resource</h4>
                                <ol class="taskList">
                                    <li class="task-list-item" id="taskIndex8">
                                        <p><label class="checkbox"><input type="checkbox"
                                                    aria-labelledby="taskIndex8"><span></span></label>Create a new Azure
                                            Storage account with the following details:</p>
                                        <ul>
                                            <li>
                                                <p>Storage account name: <strong>polystor*[yourname]*</strong></p>
                                            </li>
                                            <li>
                                                <p>Existing resource group: <strong>PolyglotData</strong></p>
                                            </li>
                                            <li>
                                                <p>Account kind: <strong>StorageV2 (general purpose v2)</strong></p>
                                            </li>
                                            <li>
                                                <p>Location: <strong>(US) East US</strong></p>
                                            </li>
                                            <li>
                                                <p>Replication: <strong>Locally-redundant storage (LRS)</strong></p>
                                            </li>
                                            <li>
                                                <p>Performance: <strong>Standard</strong></p>
                                            </li>
                                            <li>
                                                <p>Access tier (default): <strong>Hot</strong></p>
                                            </li>
                                        </ul>
                                        <blockquote>
                                            <p><strong>Note</strong>: Wait for Azure to finish creating the storage
                                                account before you move forward with the lab. You'll receive a
                                                notification when the storage account is created.</p>
                                        </blockquote>
                                    </li>
                                </ol>
                                <h4 id="review">Review</h4>
                                <p>In this exercise, you created all the Azure resources that you'll need for a polyglot
                                    data solution.</p>
                                <h3 id="exercise-2-import-and-validate-data">Exercise 2: Import and validate data</h3>
                                <h4 id="task-1-upload-image-blobs">Task 1: Upload image blobs</h4>
                                <ol class="taskList">
                                    <li class="task-list-item" id="taskIndex9">
                                        <p><label class="checkbox"><input type="checkbox"
                                                    aria-labelledby="taskIndex9"><span></span></label>Go to the blade
                                            for the <strong>polystor*[yourname]*</strong> Azure Storage account that you
                                            created earlier in this lab.</p>
                                    </li>
                                    <li class="task-list-item" id="taskIndex10">
                                        <p><label class="checkbox"><input type="checkbox"
                                                    aria-labelledby="taskIndex10"><span></span></label>Open the
                                            Containers pane, and then create a new container with the following
                                            settings:</p>
                                        <ul>
                                            <li>
                                                <p>Name: <strong>images</strong></p>
                                            </li>
                                            <li>
                                                <p>Public access level: <strong>Blob (anonymous read access for blobs
                                                        only)</strong></p>
                                            </li>
                                        </ul>
                                    </li>
                                    <li class="task-list-item" id="taskIndex11">
                                        <p><label class="checkbox"><input type="checkbox"
                                                    aria-labelledby="taskIndex11"><span></span></label>Go to the new
                                            <strong>images</strong> container, and then open the Properties pane.</p>
                                    </li>
                                    <li class="task-list-item" id="taskIndex12">
                                        <p><label class="checkbox"><input type="checkbox"
                                                    aria-labelledby="taskIndex12"><span></span></label>In the Properties
                                            pane, record the value in the <strong>URL</strong> text box.</p>
                                        <blockquote>
                                            <p><strong>Note</strong>: You'll use this value later in this lab.</p>
                                        </blockquote>
                                    </li>
                                    <li class="task-list-item" id="taskIndex13">
                                        <p><label class="checkbox"><input type="checkbox"
                                                    aria-labelledby="taskIndex13"><span></span></label>Return to the
                                            blade for the <strong>images</strong> container.</p>
                                    </li>
                                    <li class="task-list-item" id="taskIndex14">
                                        <p><label class="checkbox"><input type="checkbox"
                                                    aria-labelledby="taskIndex14"><span></span></label>Use the
                                            <strong>Upload</strong> button to upload the 42 individual
                                            <strong>.jpg</strong> image files in the <strong>Allfiles
                                                (F):\Allfiles\Labs\04\Starter\Images</strong> folder on your lab
                                            machine.</p>
                                        <blockquote>
                                            <p><strong>Note</strong>: We recommended that you enable the
                                                <strong>Overwrite if files already exist</strong> option.</p>
                                        </blockquote>
                                    </li>
                                </ol>
                                <h4 id="task-2-upload-an-sql-bacpac-file">Task 2: Upload an SQL .bacpac file</h4>
                                <ol class="taskList">
                                    <li class="task-list-item" id="taskIndex15">
                                        <p><label class="checkbox"><input type="checkbox"
                                                    aria-labelledby="taskIndex15"><span></span></label>Go back to the
                                            blade for the <strong>polystor*[yourname]*</strong> Azure Storage account,
                                            and then open the Containers pane again.</p>
                                    </li>
                                    <li class="task-list-item" id="taskIndex16">
                                        <p><label class="checkbox"><input type="checkbox"
                                                    aria-labelledby="taskIndex16"><span></span></label>Create a new
                                            container with the following settings:</p>
                                        <ul>
                                            <li>
                                                <p>Name: <strong>databases</strong></p>
                                            </li>
                                            <li>
                                                <p>Public access level: <strong>Private (no anonymous access)</strong>
                                                </p>
                                            </li>
                                        </ul>
                                    </li>
                                    <li class="task-list-item" id="taskIndex17">
                                        <p><label class="checkbox"><input type="checkbox"
                                                    aria-labelledby="taskIndex17"><span></span></label>Go to the new
                                            <strong>databases</strong> container.</p>
                                    </li>
                                    <li class="task-list-item" id="taskIndex18">
                                        <p><label class="checkbox"><input type="checkbox"
                                                    aria-labelledby="taskIndex18"><span></span></label>Use the
                                            <strong>Upload</strong> button to upload the
                                            <strong>AdventureWorks.bacpac</strong> file in the <strong>Allfiles
                                                (F):\Allfiles\Labs\04\Starter\</strong> folder on your lab machine.</p>
                                        <blockquote>
                                            <p><strong>Note</strong>: We recommended that you enable the
                                                <strong>Overwrite if files already exist</strong> option.</p>
                                        </blockquote>
                                    </li>
                                </ol>
                                <h4 id="task-3-import-an-sql-database">Task 3: Import an SQL database</h4>
                                <ol class="taskList">
                                    <li class="task-list-item" id="taskIndex19">
                                        <p><label class="checkbox"><input type="checkbox"
                                                    aria-labelledby="taskIndex19"><span></span></label>Go to the blade
                                            for the <strong>polysqlsrvr*[yourname]*</strong> SQL server resource that
                                            you created earlier in this lab.</p>
                                    </li>
                                    <li class="task-list-item" id="taskIndex20">
                                        <p><label class="checkbox"><input type="checkbox"
                                                    aria-labelledby="taskIndex20"><span></span></label>Import the
                                            database from your Azure Storage account into the SQL server instance by
                                            using the following details:</p>
                                        <ul>
                                            <li>
                                                <p>Storage account: <strong>polystor*[yourname]*</strong></p>
                                            </li>
                                            <li>
                                                <p>Database backup blob:
                                                    <strong>databases\AdventureWorks.bacpac</strong></p>
                                            </li>
                                            <li>
                                                <p>Database name: <strong>AdventureWorks</strong></p>
                                            </li>
                                            <li>
                                                <p>Server admin login: <strong>testuser</strong></p>
                                            </li>
                                            <li>
                                                <p>Password: <strong>TestPa55w.rd</strong></p>
                                            </li>
                                        </ul>
                                        <blockquote>
                                            <p><strong>Note</strong>: Wait for the database to be created before you
                                                continue with this lab. If you receive a firewall-related error on the
                                                import step, it means you did not correctly configure the <strong>Allow
                                                    Azure services to access server</strong> setting on your SQL Server
                                                earlier in the lab. Review your settings, delete the empty
                                                <strong>AdventureWorks</strong> database, and then attempt your import
                                                again.</p>
                                        </blockquote>
                                    </li>
                                </ol>
                                <h4 id="task-4-use-an-imported-sql-database">Task 4: Use an imported SQL database</h4>
                                <ol class="taskList">
                                    <li class="task-list-item" id="taskIndex21">
                                        <p><label class="checkbox"><input type="checkbox"
                                                    aria-labelledby="taskIndex21"><span></span></label>Go back to the
                                            blade for the <strong>polysqlsrvr*[yourname]*</strong> SQL server resource.
                                        </p>
                                    </li>
                                    <li class="task-list-item" id="taskIndex22">
                                        <p><label class="checkbox"><input type="checkbox"
                                                    aria-labelledby="taskIndex22"><span></span></label>Open the
                                            Firewalls and virtual networks pane.</p>
                                    </li>
                                    <li class="task-list-item" id="taskIndex23">
                                        <p><label class="checkbox"><input type="checkbox"
                                                    aria-labelledby="taskIndex23"><span></span></label>Add your current
                                            client IP address to the list of allowed IP addresses, and then save the
                                            list.</p>
                                    </li>
                                    <li class="task-list-item" id="taskIndex24">
                                        <p><label class="checkbox"><input type="checkbox"
                                                    aria-labelledby="taskIndex24"><span></span></label>Go to the blade
                                            for the <strong>AdventureWorks</strong> SQL database resource that you
                                            recently imported.</p>
                                    </li>
                                    <li class="task-list-item" id="taskIndex25">
                                        <p><label class="checkbox"><input type="checkbox"
                                                    aria-labelledby="taskIndex25"><span></span></label>Open the
                                            Connection strings pane, and then record the value of the <strong>ADO.NET
                                                (SQL Authentication)</strong> connection string. </p>
                                    </li>
                                    <li class="task-list-item" id="taskIndex26">
                                        <p><label class="checkbox"><input type="checkbox"
                                                    aria-labelledby="taskIndex26"><span></span></label>Update the
                                            connection string that you recorded by replacing the placeholder values for
                                            <em>your_username</em> and <em>your_password</em></p>
                                        <blockquote>
                                            <p><strong>Note</strong>: For example, if your connection string was
                                                originally <code class="prettyprint prettyprinted" tabindex="0"
                                                    style=""><span class="typ">Server</span><span class="pun">=</span><span class="pln">tcp</span><span class="pun">:</span><span class="pln">polysqlsrvrinstructor</span><span class="pun">.</span><span class="pln">database</span><span class="pun">.</span><span class="pln">windows</span><span class="pun">.</span><span class="pln">net</span><span class="pun">,</span><span class="lit">1433</span><span class="pun">;</span><span class="typ">Initial</span><span class="pln"> </span><span class="typ">Catalog</span><span class="pun">=</span><span class="typ">AdventureWorks</span><span class="pun">;</span><span class="typ">User</span><span class="pln"> ID</span><span class="pun">={</span><span class="pln">your_username</span><span class="pun">};</span><span class="typ">Password</span><span class="pun">={</span><span class="pln">your_password</span><span class="pun">};</span></code>,
                                                your updated connection string will be <code
                                                    class="prettyprint prettyprinted" tabindex="0"
                                                    style=""><span class="typ">Server</span><span class="pun">=</span><span class="pln">tcp</span><span class="pun">:</span><span class="pln">polysqlsrvrinstructor</span><span class="pun">.</span><span class="pln">database</span><span class="pun">.</span><span class="pln">windows</span><span class="pun">.</span><span class="pln">net</span><span class="pun">,</span><span class="lit">1433</span><span class="pun">;</span><span class="typ">Initial</span><span class="pln"> </span><span class="typ">Catalog</span><span class="pun">=</span><span class="typ">AdventureWorks</span><span class="pun">;</span><span class="typ">User</span><span class="pln"> ID</span><span class="pun">=</span><span class="pln">testuser</span><span class="pun">;</span><span class="typ">Password</span><span class="pun">=</span><span class="typ">TestPa55w</span><span class="pun">.</span><span class="pln">rd</span><span class="pun">;</span></code>
                                            </p>
                                        </blockquote>
                                    </li>
                                    <li class="task-list-item" id="taskIndex27">
                                        <p><label class="checkbox"><input type="checkbox"
                                                    aria-labelledby="taskIndex27"><span></span></label>Go back to the
                                            blade for the <strong>AdventureWorks</strong> SQL database resource.</p>
                                    </li>
                                    <li class="task-list-item" id="taskIndex28">
                                        <p><label class="checkbox"><input type="checkbox"
                                                    aria-labelledby="taskIndex28"><span></span></label>Open the Query
                                            editor pane, and then sign in by using the following credentials:</p>
                                        <ul>
                                            <li>
                                                <p>Username: <strong>testuser</strong></p>
                                            </li>
                                            <li>
                                                <p>Password: <strong>TestPa55w.rd</strong></p>
                                            </li>
                                        </ul>
                                    </li>
                                    <li class="task-list-item" id="taskIndex29">
                                        <p><label class="checkbox"><input type="checkbox"
                                                    aria-labelledby="taskIndex29"><span></span></label>Run the following
                                            query, and then observe the results:</p>
                                        <pre><code class="prettyprint prettyprinted" tabindex="0" style=""><span class="pln">SELECT </span><span class="pun">*</span><span class="pln"> FROM </span><span class="typ">AdventureWorks</span><span class="pun">.</span><span class="pln">dbo</span><span class="pun">.</span><span class="typ">Models</span></code></pre>
                                        <blockquote>
                                            <p><strong>Note</strong>: This query will return a list of models from the
                                                home page of the web application.</p>
                                        </blockquote>
                                    </li>
                                    <li class="task-list-item" id="taskIndex30">
                                        <p><label class="checkbox"><input type="checkbox"
                                                    aria-labelledby="taskIndex30"><span></span></label>Run this
                                            additional query, and then observe the results:</p>
                                        <pre><code class="prettyprint prettyprinted" tabindex="0" style=""><span class="pln">SELECT </span><span class="pun">*</span><span class="pln"> FROM </span><span class="typ">AdventureWorks</span><span class="pun">.</span><span class="pln">dbo</span><span class="pun">.</span><span class="typ">Products</span></code></pre>
                                        <blockquote>
                                            <p><strong>Note</strong>: This query will return a list of products that are
                                                associated with each model.</p>
                                        </blockquote>
                                    </li>
                                </ol>
                                <h4 id="review-1">Review</h4>
                                <p>In this exercise, you imported all the resources that you'll use with your web
                                    application.</p>
                                <h3 id="exercise-3-open-and-configure-a-net-web-application">Exercise 3: Open and
                                    configure a .NET web application</h3>
                                <h4 id="task-1-open-and-build-the-web-application">Task 1: Open and build the web
                                    application</h4>
                                <ol class="taskList">
                                    <li class="task-list-item" id="taskIndex31">
                                        <p><label class="checkbox"><input type="checkbox"
                                                    aria-labelledby="taskIndex31"><span></span></label>Using Visual
                                            Studio Code, open the solution folder found at <strong>Allfiles
                                                (F):\Allfiles\Labs\04\Starter\AdventureWorks</strong>.</p>
                                    </li>
                                    <li class="task-list-item" id="taskIndex32">
                                        <p><label class="checkbox"><input type="checkbox"
                                                    aria-labelledby="taskIndex32"><span></span></label>Using a terminal,
                                            build the .NET solution:</p>
                                        <pre><code class="prettyprint prettyprinted" tabindex="0" style=""><span class="pln">dotnet build</span></code></pre>
                                        <blockquote>
                                            <p><strong>Note</strong>: The <strong>dotnet build</strong> command will
                                                automatically restore any missing NuGet packages prior to building all
                                                projects in the folder.</p>
                                        </blockquote>
                                    </li>
                                    <li class="task-list-item" id="taskIndex33">
                                        <p><label class="checkbox"><input type="checkbox"
                                                    aria-labelledby="taskIndex33"><span></span></label>Close the current
                                            terminal.</p>
                                    </li>
                                </ol>
                                <h4 id="task-2-update-the-sql-connection-string">Task 2: Update the SQL connection
                                    string</h4>
                                <ol class="taskList">
                                    <li class="task-list-item" id="taskIndex34">
                                        <p><label class="checkbox"><input type="checkbox"
                                                    aria-labelledby="taskIndex34"><span></span></label>Open the
                                            <strong>AdventureWorks.Web/appsettings.json</strong> file in Visual Studio
                                            Code.</p>
                                    </li>
                                    <li class="task-list-item" id="taskIndex35">
                                        <p><label class="checkbox"><input type="checkbox"
                                                    aria-labelledby="taskIndex35"><span></span></label>Replace the value
                                            of the <em>ConnectionStrings.AdventureWorksSqlContext</em> property with the
                                            <strong>ADO.NET (SQL Authentication) connection string</strong> of the SQL
                                            database that you recorded earlier in this lab.</p>
                                        <blockquote>
                                            <p><strong>Note</strong>: It's important that you use your updated
                                                connection string here. The original connection string copied from the
                                                portal won't have the username and password necessary to connect to the
                                                SQL database.</p>
                                        </blockquote>
                                    </li>
                                    <li class="task-list-item" id="taskIndex36">
                                        <p><label class="checkbox"><input type="checkbox"
                                                    aria-labelledby="taskIndex36"><span></span></label>Save the
                                            <strong>appsettings.json</strong> file.</p>
                                    </li>
                                </ol>
                                <h4 id="task-3-update-the-blob-base-url">Task 3: Update the blob base URL</h4>
                                <ol class="taskList">
                                    <li class="task-list-item" id="taskIndex37">
                                        <p><label class="checkbox"><input type="checkbox"
                                                    aria-labelledby="taskIndex37"><span></span></label>Replace the value
                                            of the <em>Settings.BlobContainerUrl</em> property with the <em>URL</em>
                                            property of the <strong>Azure Storage</strong> blob container named
                                            <strong>images</strong> that you recorded earlier in this lab.</p>
                                    </li>
                                    <li class="task-list-item" id="taskIndex38">
                                        <p><label class="checkbox"><input type="checkbox"
                                                    aria-labelledby="taskIndex38"><span></span></label>Save the
                                            <strong>appsettings.json</strong> file.</p>
                                    </li>
                                </ol>
                                <h4 id="task-4-validate-the-web-application">Task 4: Validate the web application</h4>
                                <ol class="taskList">
                                    <li class="task-list-item" id="taskIndex39">
                                        <p><label class="checkbox"><input type="checkbox"
                                                    aria-labelledby="taskIndex39"><span></span></label>Using a terminal,
                                            change your context to the <strong>AdventureWorks.Web</strong> folder:</p>
                                        <pre><code class="prettyprint prettyprinted" tabindex="0" style=""><span class="pln">cd </span><span class="pun">.</span><span class="pln">\AdventureWorks</span><span class="pun">.</span><span class="typ">Web</span><span class="pln">\</span></code></pre>
                                    </li>
                                    <li class="task-list-item" id="taskIndex40">
                                        <p><label class="checkbox"><input type="checkbox"
                                                    aria-labelledby="taskIndex40"><span></span></label>Using the same
                                            terminal, run the ASP.NET web application project:</p>
                                        <pre><code class="prettyprint prettyprinted" tabindex="0" style=""><span class="pln">dotnet run</span></code></pre>
                                        <blockquote>
                                            <p><strong>Note</strong>: The <strong>dotnet run</strong> command will
                                                automatically build any changes to the project and then start the web
                                                application without a debugger attached. The command will output the URL
                                                of the running application and any assigned ports.</p>
                                        </blockquote>
                                    </li>
                                    <li class="task-list-item" id="taskIndex41">
                                        <p><label class="checkbox"><input type="checkbox"
                                                    aria-labelledby="taskIndex41"><span></span></label>Open the
                                            Microsoft Edge browser.</p>
                                    </li>
                                    <li class="task-list-item" id="taskIndex42">
                                        <p><label class="checkbox"><input type="checkbox"
                                                    aria-labelledby="taskIndex42"><span></span></label>In the open
                                            browser window, browse to the web application that's hosted at
                                            <strong>localhost</strong> on port <strong>5000</strong>.</p>
                                        <blockquote>
                                            <p><strong>Note</strong>: The URL is <a
                                                    href="http://localhost:5000/">http://localhost:5000</a>.</p>
                                        </blockquote>
                                    </li>
                                    <li class="task-list-item" id="taskIndex43">
                                        <p><label class="checkbox"><input type="checkbox"
                                                    aria-labelledby="taskIndex43"><span></span></label>In the web
                                            application, observe the list of models displayed from the front page.</p>
                                    </li>
                                    <li class="task-list-item" id="taskIndex44">
                                        <p><label class="checkbox"><input type="checkbox"
                                                    aria-labelledby="taskIndex44"><span></span></label>Find the
                                            <strong>Water Bottle</strong> model, and then select <strong>View
                                                Details</strong>.</p>
                                    </li>
                                    <li class="task-list-item" id="taskIndex45">
                                        <p><label class="checkbox"><input type="checkbox"
                                                    aria-labelledby="taskIndex45"><span></span></label>From the
                                            <strong>Water Bottle</strong> product detail page, find <strong>Add to
                                                Cart</strong>, and then observe that the checkout functionality is
                                            currently disabled.</p>
                                    </li>
                                    <li class="task-list-item" id="taskIndex46">
                                        <p><label class="checkbox"><input type="checkbox"
                                                    aria-labelledby="taskIndex46"><span></span></label>Close the browser
                                            window that's displaying your web application.</p>
                                    </li>
                                    <li class="task-list-item" id="taskIndex47">
                                        <p><label class="checkbox"><input type="checkbox"
                                                    aria-labelledby="taskIndex47"><span></span></label>Return to the
                                            <strong>Visual Studio Code</strong> window.</p>
                                    </li>
                                    <li class="task-list-item" id="taskIndex48">
                                        <p><label class="checkbox"><input type="checkbox"
                                                    aria-labelledby="taskIndex48"><span></span></label>Close the current
                                            terminal.</p>
                                    </li>
                                </ol>
                                <h4 id="review-2">Review</h4>
                                <p>In this exercise, you configured your ASP.NET web application to connect to your
                                    resources in Azure.</p>
                                <h3 id="exercise-4-migrating-sql-data-to-azure-cosmos-db">Exercise 4: Migrating SQL data
                                    to Azure Cosmos DB</h3>
                                <h4 id="task-1-create-a-migration-project">Task 1: Create a migration project</h4>
                                <ol class="taskList">
                                    <li class="task-list-item" id="taskIndex49">
                                        <p><label class="checkbox"><input type="checkbox"
                                                    aria-labelledby="taskIndex49"><span></span></label>Using a terminal,
                                            create a new .NET console project named
                                            <strong>AdventureWorks.Migrate</strong> in a folder with the same name:</p>
                                        <pre><code class="prettyprint prettyprinted" tabindex="0" style=""><span class="pln">dotnet </span><span class="kwd">new</span><span class="pln"> console </span><span class="pun">--</span><span class="pln">name </span><span class="typ">AdventureWorks</span><span class="pun">.</span><span class="typ">Migrate</span></code></pre>
                                        <blockquote>
                                            <p><strong>Note</strong>: The <strong>dotnet new</strong> command will
                                                create a new <strong>console</strong> project in a folder with the same
                                                name as the project.</p>
                                        </blockquote>
                                    </li>
                                    <li class="task-list-item" id="taskIndex50">
                                        <p><label class="checkbox"><input type="checkbox"
                                                    aria-labelledby="taskIndex50"><span></span></label>Using the same
                                            terminal, add a reference to the existing
                                            <strong>AdventureWorks.Models</strong> project:</p>
                                        <pre><code class="prettyprint prettyprinted" tabindex="0" style=""><span class="pln">dotnet </span><span class="kwd">add</span><span class="pln"> </span><span class="pun">.</span><span class="pln">\AdventureWorks</span><span class="pun">.</span><span class="typ">Migrate</span><span class="pln">\AdventureWorks</span><span class="pun">.</span><span class="typ">Migrate</span><span class="pun">.</span><span class="pln">csproj reference </span><span class="pun">.</span><span class="pln">\AdventureWorks</span><span class="pun">.</span><span class="typ">Models</span><span class="pln">\AdventureWorks</span><span class="pun">.</span><span class="typ">Models</span><span class="pun">.</span><span class="pln">csproj</span></code></pre>
                                        <blockquote>
                                            <p><strong>Note</strong>: The <strong>dotnet add reference</strong> command
                                                will add a reference to the model classes contained in the
                                                <strong>AdventureWorks.Models</strong> project.</p>
                                        </blockquote>
                                    </li>
                                    <li class="task-list-item" id="taskIndex51">
                                        <p><label class="checkbox"><input type="checkbox"
                                                    aria-labelledby="taskIndex51"><span></span></label>Using the same
                                            terminal, add a reference to the existing
                                            <strong>AdventureWorks.Context</strong> project:</p>
                                        <pre><code class="prettyprint prettyprinted" tabindex="0" style=""><span class="pln">dotnet </span><span class="kwd">add</span><span class="pln"> </span><span class="pun">.</span><span class="pln">\AdventureWorks</span><span class="pun">.</span><span class="typ">Migrate</span><span class="pln">\AdventureWorks</span><span class="pun">.</span><span class="typ">Migrate</span><span class="pun">.</span><span class="pln">csproj reference </span><span class="pun">.</span><span class="pln">\AdventureWorks</span><span class="pun">.</span><span class="typ">Context</span><span class="pln">\AdventureWorks</span><span class="pun">.</span><span class="typ">Context</span><span class="pun">.</span><span class="pln">csproj</span></code></pre>
                                        <blockquote>
                                            <p><strong>Note</strong>: The <strong>dotnet add reference</strong> command
                                                will add a reference to the context classes contained in the
                                                <strong>AdventureWorks.Context</strong> project.</p>
                                        </blockquote>
                                    </li>
                                    <li class="task-list-item" id="taskIndex52">
                                        <p><label class="checkbox"><input type="checkbox"
                                                    aria-labelledby="taskIndex52"><span></span></label>Using the same
                                            terminal, change your context to the <strong>AdventureWorks.Migrate</strong>
                                            folder:</p>
                                        <pre><code class="prettyprint prettyprinted" tabindex="0" style=""><span class="pln">cd </span><span class="pun">.</span><span class="pln">\AdventureWorks</span><span class="pun">.</span><span class="typ">Migrate</span><span class="pln">\</span></code></pre>
                                    </li>
                                    <li class="task-list-item" id="taskIndex53">
                                        <p><label class="checkbox"><input type="checkbox"
                                                    aria-labelledby="taskIndex53"><span></span></label>Using the same
                                            terminal, import version 3.0.1 of
                                            <strong>Microsoft.EntityFrameworkCore.SqlServer</strong> from NuGet:</p>
                                        <pre><code class="prettyprint prettyprinted" tabindex="0" style=""><span class="pln">dotnet </span><span class="kwd">add</span><span class="pln"> </span><span class="kwd">package</span><span class="pln"> </span><span class="typ">Microsoft</span><span class="pun">.</span><span class="typ">EntityFrameworkCore</span><span class="pun">.</span><span class="typ">SqlServer</span><span class="pln"> </span><span class="pun">--</span><span class="pln">version </span><span class="lit">3.0</span><span class="pun">.</span><span class="lit">1</span></code></pre>
                                        <blockquote>
                                            <p><strong>Note</strong>: The <strong>dotnet add package</strong> command
                                                will add the <strong>Microsoft.EntityFrameworkCore.SqlServer</strong>
                                                package from <strong>NuGet</strong>. For more information, go to: <a
                                                    href="https://www.nuget.org/packages/Microsoft.EntityFrameworkCore.SqlServer/3.0.1"
                                                    target="_blank">Microsoft.EntityFrameworkCore.SqlServer</a>.</p>
                                        </blockquote>
                                    </li>
                                    <li class="task-list-item" id="taskIndex54">
                                        <p><label class="checkbox"><input type="checkbox"
                                                    aria-labelledby="taskIndex54"><span></span></label>Using the same
                                            terminal, import version 3.4.1 of <strong>Microsoft.Azure.Cosmos</strong>
                                            from NuGet:</p>
                                        <pre><code class="prettyprint prettyprinted" tabindex="0" style=""><span class="pln">dotnet </span><span class="kwd">add</span><span class="pln"> </span><span class="kwd">package</span><span class="pln"> </span><span class="typ">Microsoft</span><span class="pun">.</span><span class="typ">Azure</span><span class="pun">.</span><span class="typ">Cosmos</span><span class="pln"> </span><span class="pun">--</span><span class="pln">version </span><span class="lit">3.4</span><span class="pun">.</span><span class="lit">1</span></code></pre>
                                        <blockquote>
                                            <p><strong>Note</strong>: The <strong>dotnet add package</strong> command
                                                will add the <strong>Microsoft.Azure.Cosmos</strong> package from
                                                <strong>NuGet</strong>. For more information, go to: <a
                                                    href="https://www.nuget.org/packages/Microsoft.Azure.Cosmos/3.4.1"
                                                    target="_blank">Microsoft.Azure.Cosmos</a>.</p>
                                        </blockquote>
                                    </li>
                                    <li class="task-list-item" id="taskIndex55">
                                        <p><label class="checkbox"><input type="checkbox"
                                                    aria-labelledby="taskIndex55"><span></span></label>Using the same
                                            terminal, build the .NET console application:</p>
                                        <pre><code class="prettyprint prettyprinted" tabindex="0" style=""><span class="pln">dotnet build</span></code></pre>
                                    </li>
                                    <li class="task-list-item" id="taskIndex56">
                                        <p><label class="checkbox"><input type="checkbox"
                                                    aria-labelledby="taskIndex56"><span></span></label>Close the current
                                            terminal.</p>
                                    </li>
                                </ol>
                                <h4 id="task-2-create-a-net-class">Task 2: Create a .NET class</h4>
                                <ol class="taskList">
                                    <li class="task-list-item" id="taskIndex57">
                                        <p><label class="checkbox"><input type="checkbox"
                                                    aria-labelledby="taskIndex57"><span></span></label>Open the
                                            <strong>AdventureWorks.Migrate/Program.cs</strong> file in Visual Studio
                                            Code.</p>
                                    </li>
                                    <li class="task-list-item" id="taskIndex58">
                                        <p><label class="checkbox"><input type="checkbox"
                                                    aria-labelledby="taskIndex58"><span></span></label>Delete all
                                            existing code in the <strong>Program.cs</strong> file.</p>
                                    </li>
                                    <li class="task-list-item" id="taskIndex59">
                                        <p><label class="checkbox"><input type="checkbox"
                                                    aria-labelledby="taskIndex59"><span></span></label>Add the following
                                            <strong>using</strong> directives for libraries that will be referenced by
                                            the application:</p>
                                        <pre><code class="prettyprint prettyprinted" tabindex="0" style=""><span class="kwd">using</span><span class="pln"> </span><span class="typ">AdventureWorks</span><span class="pun">.</span><span class="typ">Context</span><span class="pun">;</span><span class="pln">
</span><span class="kwd">using</span><span class="pln"> </span><span class="typ">AdventureWorks</span><span class="pun">.</span><span class="typ">Models</span><span class="pun">;</span><span class="pln">
</span><span class="kwd">using</span><span class="pln"> </span><span class="typ">Microsoft</span><span class="pun">.</span><span class="typ">Azure</span><span class="pun">.</span><span class="typ">Cosmos</span><span class="pun">;</span><span class="pln">
</span><span class="kwd">using</span><span class="pln"> </span><span class="typ">Microsoft</span><span class="pun">.</span><span class="typ">EntityFrameworkCore</span><span class="pun">;</span><span class="pln">
</span><span class="kwd">using</span><span class="pln"> </span><span class="typ">System</span><span class="pun">;</span><span class="pln">
</span><span class="kwd">using</span><span class="pln"> </span><span class="typ">System</span><span class="pun">.</span><span class="typ">Collections</span><span class="pun">.</span><span class="typ">Generic</span><span class="pun">;</span><span class="pln">
</span><span class="kwd">using</span><span class="pln"> </span><span class="typ">System</span><span class="pun">.</span><span class="typ">Linq</span><span class="pun">;</span><span class="pln">
</span><span class="kwd">using</span><span class="pln"> </span><span class="typ">System</span><span class="pun">.</span><span class="typ">Threading</span><span class="pun">.</span><span class="typ">Tasks</span><span class="pun">;</span></code></pre>
                                    </li>
                                    <li class="task-list-item" id="taskIndex60">
                                        <p><label class="checkbox"><input type="checkbox"
                                                    aria-labelledby="taskIndex60"><span></span></label>Create a new
                                            <strong>Program</strong> class with two constant string properties and an
                                            asynchronous <strong>Main</strong> entry point method:</p>
                                        <pre><code class="prettyprint prettyprinted" tabindex="0" style=""><span class="kwd">public</span><span class="pln"> </span><span class="kwd">class</span><span class="pln"> </span><span class="typ">Program</span><span class="pln">
</span><span class="pun">{</span><span class="pln">
    </span><span class="kwd">private</span><span class="pln"> </span><span class="kwd">const</span><span class="pln"> </span><span class="kwd">string</span><span class="pln"> sqlDBConnectionString </span><span class="pun">=</span><span class="pln"> </span><span class="str">""</span><span class="pun">;</span><span class="pln">
    </span><span class="kwd">private</span><span class="pln"> </span><span class="kwd">const</span><span class="pln"> </span><span class="kwd">string</span><span class="pln"> cosmosDBConnectionString </span><span class="pun">=</span><span class="pln"> </span><span class="str">""</span><span class="pun">;</span><pre><code><span class="kwd">public</span><span class="pln"> </span><span class="kwd">static</span><span class="pln"> </span><span class="kwd">async</span><span class="pln"> </span><span class="typ">Task</span><span class="pln"> </span><span class="typ">Main</span><span class="pun">(</span><span class="kwd">string</span><span class="pun">[]</span><span class="pln"> args</span><span class="pun">)</span><span class="pln">
</span><span class="pun">{</span><span class="pln">
</span><span class="pun">}</span><span class="pln">
</span></code></pre><span class="pun">}</span></code></pre>
                                    </li>
                                    <li class="task-list-item" id="taskIndex61">
                                        <p><label class="checkbox"><input type="checkbox"
                                                    aria-labelledby="taskIndex61"><span></span></label>Update the
                                            <strong>sqlDBConnectionString</strong> string constant by setting its value
                                            to the <strong>ADO.NET (SQL Authentication) connection string</strong> of
                                            the SQL database that you recorded earlier in this lab.</p>
                                        <blockquote>
                                            <p><strong>Note</strong>: It's important that you use your updated
                                                connection string here. The original connection string copied from the
                                                portal won't have the username and password necessary to connect to the
                                                SQL database.</p>
                                        </blockquote>
                                    </li>
                                    <li class="task-list-item" id="taskIndex62">
                                        <p><label class="checkbox"><input type="checkbox"
                                                    aria-labelledby="taskIndex62"><span></span></label>Update the
                                            <strong>cosmosDBConnectionString</strong> string constant by setting its
                                            value to the <strong>PRIMARY CONNECTION STRING</strong> of the Azure Cosmos
                                            DB account that you recorded earlier in this lab.</p>
                                    </li>
                                </ol>
                                <h4 id="task-3-get-sql-database-records-by-using-entity-framework">Task 3: Get SQL
                                    database records by using Entity Framework</h4>
                                <ol class="taskList">
                                    <li class="task-list-item" id="taskIndex63">
                                        <p><label class="checkbox"><input type="checkbox"
                                                    aria-labelledby="taskIndex63"><span></span></label>Within the
                                            <strong>Main</strong> method, add the following blocks of code to export all
                                            model and product records from SQL Database to local memory:</p>
                                        <pre><code class="prettyprint prettyprinted" tabindex="0" style=""><span class="kwd">await</span><span class="pln"> </span><span class="typ">Console</span><span class="pun">.</span><span class="typ">Out</span><span class="pun">.</span><span class="typ">WriteLineAsync</span><span class="pun">(</span><span class="str">"Start Migration"</span><span class="pun">);</span><span class="pln">
</span><span class="kwd">using</span><span class="pln"> </span><span class="typ">AdventureWorksSqlContext</span><span class="pln"> context </span><span class="pun">=</span><span class="pln"> </span><span class="kwd">new</span><span class="pln"> </span><span class="typ">AdventureWorksSqlContext</span><span class="pun">(</span><span class="pln">sqlDBConnectionString</span><span class="pun">);</span><span class="pln">
</span><span class="typ">List</span><span class="pun">&lt;</span><span class="typ">Model</span><span class="pun">&gt;</span><span class="pln"> items </span><span class="pun">=</span><span class="pln"> </span><span class="kwd">await</span><span class="pln"> context</span><span class="pun">.</span><span class="typ">Models</span><span class="pln">
    </span><span class="pun">.</span><span class="typ">Include</span><span class="pun">(</span><span class="pln">m </span><span class="pun">=&gt;</span><span class="pln"> m</span><span class="pun">.</span><span class="typ">Products</span><span class="pun">)</span><span class="pln">
    </span><span class="pun">.</span><span class="typ">ToListAsync</span><span class="pun">&lt;</span><span class="typ">Model</span><span class="pun">&gt;();</span><span class="pln">
</span><span class="kwd">await</span><span class="pln"> </span><span class="typ">Console</span><span class="pun">.</span><span class="typ">Out</span><span class="pun">.</span><span class="typ">WriteLineAsync</span><span class="pun">(</span><span class="pln">$</span><span class="str">"Total Azure SQL DB Records: {items.Count}"</span><span class="pun">);</span></code></pre>
                                    </li>
                                    <li class="task-list-item" id="taskIndex64">
                                        <p><label class="checkbox"><input type="checkbox"
                                                    aria-labelledby="taskIndex64"><span></span></label>Save the
                                            <strong>Program.cs</strong> file.</p>
                                    </li>
                                    <li class="task-list-item" id="taskIndex65">
                                        <p><label class="checkbox"><input type="checkbox"
                                                    aria-labelledby="taskIndex65"><span></span></label>Using a terminal,
                                            change your context to the <strong>AdventureWorks.Migrate</strong> folder:
                                        </p>
                                        <pre><code class="prettyprint prettyprinted" tabindex="0" style=""><span class="pln">cd </span><span class="pun">.</span><span class="pln">\AdventureWorks</span><span class="pun">.</span><span class="typ">Migrate</span><span class="pln">\</span></code></pre>
                                    </li>
                                    <li class="task-list-item" id="taskIndex66">
                                        <p><label class="checkbox"><input type="checkbox"
                                                    aria-labelledby="taskIndex66"><span></span></label>Using the same
                                            terminal, build the .NET console application project:</p>
                                        <pre><code class="prettyprint prettyprinted" tabindex="0" style=""><span class="pln">dotnet build</span></code></pre>
                                        <blockquote>
                                            <p><strong>Note</strong>: If there are any build errors, review the
                                                <strong>Program.cs</strong> file in the <strong>Allfiles
                                                    (F):\Allfiles\Labs\04\Solution\AdventureWorks\AdventureWorks.Migrate</strong>
                                                folder.</p>
                                        </blockquote>
                                    </li>
                                    <li class="task-list-item" id="taskIndex67">
                                        <p><label class="checkbox"><input type="checkbox"
                                                    aria-labelledby="taskIndex67"><span></span></label>Close the current
                                            terminal.</p>
                                    </li>
                                </ol>
                                <h4 id="task-4-insert-items-into-azure-cosmos-db">Task 4: Insert items into Azure Cosmos
                                    DB</h4>
                                <ol class="taskList">
                                    <li class="task-list-item" id="taskIndex68">
                                        <p><label class="checkbox"><input type="checkbox"
                                                    aria-labelledby="taskIndex68"><span></span></label>Still within the
                                            <strong>Main</strong> method, add the following blocks of code to import the
                                            in-memory model and product data as documents to Azure Cosmos DB:</p>
                                        <pre><code class="prettyprint prettyprinted" tabindex="0" style=""><span class="kwd">using</span><span class="pln"> </span><span class="typ">CosmosClient</span><span class="pln"> client </span><span class="pun">=</span><span class="pln"> </span><span class="kwd">new</span><span class="pln"> </span><span class="typ">CosmosClient</span><span class="pun">(</span><span class="pln">cosmosDBConnectionString</span><span class="pun">);</span><span class="pln">
</span><span class="typ">Database</span><span class="pln"> database </span><span class="pun">=</span><span class="pln"> </span><span class="kwd">await</span><span class="pln"> client</span><span class="pun">.</span><span class="typ">CreateDatabaseIfNotExistsAsync</span><span class="pun">(</span><span class="str">"Retail"</span><span class="pun">);</span><span class="pln">
</span><span class="typ">Container</span><span class="pln"> container </span><span class="pun">=</span><span class="pln"> </span><span class="kwd">await</span><span class="pln"> database</span><span class="pun">.</span><span class="typ">CreateContainerIfNotExistsAsync</span><span class="pun">(</span><span class="str">"Online"</span><span class="pun">,</span><span class="pln">
    partitionKeyPath</span><span class="pun">:</span><span class="pln"> $</span><span class="str">"/{nameof(Model.Category)}"</span><span class="pun">,</span><span class="pln">
    throughput</span><span class="pun">:</span><span class="pln"> </span><span class="lit">1000</span><span class="pln">
</span><span class="pun">);</span><span class="pln">
</span><span class="kwd">int</span><span class="pln"> count </span><span class="pun">=</span><span class="pln"> </span><span class="lit">0</span><span class="pun">;</span><span class="pln">
</span><span class="kwd">foreach</span><span class="pln"> </span><span class="pun">(</span><span class="kwd">var</span><span class="pln"> item </span><span class="kwd">in</span><span class="pln"> items</span><span class="pun">)</span><span class="pln">
</span><span class="pun">{</span><span class="pln">
    </span><span class="typ">ItemResponse</span><span class="pun">&lt;</span><span class="typ">Model</span><span class="pun">&gt;</span><span class="pln"> document </span><span class="pun">=</span><span class="pln"> </span><span class="kwd">await</span><span class="pln"> container</span><span class="pun">.</span><span class="typ">UpsertItemAsync</span><span class="pun">&lt;</span><span class="typ">Model</span><span class="pun">&gt;(</span><span class="pln">item</span><span class="pun">);</span><span class="pln">
    </span><span class="kwd">await</span><span class="pln"> </span><span class="typ">Console</span><span class="pun">.</span><span class="typ">Out</span><span class="pun">.</span><span class="typ">WriteLineAsync</span><span class="pun">(</span><span class="pln">$</span><span class="str">"Upserted document #{++count:000} [Activity Id: {document.ActivityId}]"</span><span class="pun">);</span><span class="pln">
</span><span class="pun">}</span><span class="pln">
</span><span class="kwd">await</span><span class="pln"> </span><span class="typ">Console</span><span class="pun">.</span><span class="typ">Out</span><span class="pun">.</span><span class="typ">WriteLineAsync</span><span class="pun">(</span><span class="pln">$</span><span class="str">"Total Azure Cosmos DB Documents: {count}"</span><span class="pun">);</span></code></pre>
                                    </li>
                                    <li class="task-list-item" id="taskIndex69">
                                        <p><label class="checkbox"><input type="checkbox"
                                                    aria-labelledby="taskIndex69"><span></span></label>Save the
                                            <strong>Program.cs</strong> file.</p>
                                    </li>
                                    <li class="task-list-item" id="taskIndex70">
                                        <p><label class="checkbox"><input type="checkbox"
                                                    aria-labelledby="taskIndex70"><span></span></label>Using a terminal,
                                            change your context to the <strong>AdventureWorks.Migrate</strong> folder:
                                        </p>
                                        <pre><code class="prettyprint prettyprinted" tabindex="0" style=""><span class="pln">cd </span><span class="pun">.</span><span class="pln">\AdventureWorks</span><span class="pun">.</span><span class="typ">Migrate</span><span class="pln">\</span></code></pre>
                                    </li>
                                    <li class="task-list-item" id="taskIndex71">
                                        <p><label class="checkbox"><input type="checkbox"
                                                    aria-labelledby="taskIndex71"><span></span></label>Using the same
                                            terminal, build the .NET console application project:</p>
                                        <pre><code class="prettyprint prettyprinted" tabindex="0" style=""><span class="pln">dotnet build</span></code></pre>
                                        <blockquote>
                                            <p><strong>Note</strong>: If there are any build errors, review the
                                                <strong>Program.cs</strong> file in the <strong>Allfiles
                                                    (F):\Allfiles\Labs\04\Solution\AdventureWorks\AdventureWorks.Migrate</strong>
                                                folder.</p>
                                        </blockquote>
                                    </li>
                                </ol>
                                <h4 id="task-5-perform-a-migration">Task 5: Perform a migration</h4>
                                <ol class="taskList">
                                    <li class="task-list-item" id="taskIndex72">
                                        <p><label class="checkbox"><input type="checkbox"
                                                    aria-labelledby="taskIndex72"><span></span></label>Using the same
                                            terminal, run the .NET console application project:</p>
                                        <pre><code class="prettyprint prettyprinted" tabindex="0" style=""><span class="pln">dotnet run</span></code></pre>
                                        <blockquote>
                                            <p><strong>Note</strong>: The <strong>dotnet run</strong> command will start
                                                the console application.</p>
                                        </blockquote>
                                    </li>
                                    <li class="task-list-item" id="taskIndex73">
                                        <p><label class="checkbox"><input type="checkbox"
                                                    aria-labelledby="taskIndex73"><span></span></label>Observe the
                                            various data that prints to the screen, including initial SQL record count,
                                            individual upsert activity identifiers, and final Azure Cosmos DB document
                                            count.</p>
                                    </li>
                                    <li class="task-list-item" id="taskIndex74">
                                        <p><label class="checkbox"><input type="checkbox"
                                                    aria-labelledby="taskIndex74"><span></span></label>Close the current
                                            terminal.</p>
                                    </li>
                                </ol>
                                <h4 id="task-6-validate-the-migration">Task 6: Validate the migration</h4>
                                <ol class="taskList">
                                    <li class="task-list-item" id="taskIndex75">
                                        <p><label class="checkbox"><input type="checkbox"
                                                    aria-labelledby="taskIndex75"><span></span></label>Return to the
                                            <strong>Microsoft Edge</strong> browser window with the Azure portal.</p>
                                    </li>
                                    <li class="task-list-item" id="taskIndex76">
                                        <p><label class="checkbox"><input type="checkbox"
                                                    aria-labelledby="taskIndex76"><span></span></label>Go to the blade
                                            for the <strong>polycosmos*[yourname]*</strong> Azure Cosmos DB account that
                                            you created earlier in this lab.</p>
                                    </li>
                                    <li class="task-list-item" id="taskIndex77">
                                        <p><label class="checkbox"><input type="checkbox"
                                                    aria-labelledby="taskIndex77"><span></span></label>Open the Data
                                            Explorer pane.</p>
                                    </li>
                                    <li class="task-list-item" id="taskIndex78">
                                        <p><label class="checkbox"><input type="checkbox"
                                                    aria-labelledby="taskIndex78"><span></span></label>Create a new
                                            <strong>SQL query</strong> tab within the context of the
                                            <strong>Retail</strong> database and <strong>Online</strong> container.</p>
                                    </li>
                                    <li class="task-list-item" id="taskIndex79">
                                        <p><label class="checkbox"><input type="checkbox"
                                                    aria-labelledby="taskIndex79"><span></span></label>Run the following
                                            query, and then observe the results:</p>
                                        <pre><code class="prettyprint prettyprinted" tabindex="0" style=""><span class="pln">SELECT </span><span class="pun">*</span><span class="pln"> FROM models</span></code></pre>
                                    </li>
                                    <li class="task-list-item" id="taskIndex80">
                                        <p><label class="checkbox"><input type="checkbox"
                                                    aria-labelledby="taskIndex80"><span></span></label>Run the following
                                            query, and then observe the results:</p>
                                        <pre><code class="prettyprint prettyprinted" tabindex="0" style=""><span class="pln">SELECT VALUE COUNT</span><span class="pun">(</span><span class="lit">1</span><span class="pun">)</span><span class="pln"> FROM models</span></code></pre>
                                    </li>
                                </ol>
                                <h4 id="review-3">Review</h4>
                                <p>In this exercise, you used Entity Framework and the .NET SDK for Azure Cosmos DB to
                                    migrate data from SQL Database to Azure Cosmos DB.</p>
                                <h3 id="exercise-5-accessing-azure-cosmos-db-by-using-net">Exercise 5: Accessing Azure
                                    Cosmos DB by using .NET</h3>
                                <h4 id="task-1-update-library-with-the-cosmos-sdk-and-references">Task 1: Update library
                                    with the Cosmos SDK and references</h4>
                                <ol class="taskList">
                                    <li class="task-list-item" id="taskIndex81">
                                        <p><label class="checkbox"><input type="checkbox"
                                                    aria-labelledby="taskIndex81"><span></span></label>Using a terminal,
                                            change your context to the <strong>AdventureWorks.Context</strong> folder:
                                        </p>
                                        <pre><code class="prettyprint prettyprinted" tabindex="0" style=""><span class="pln">cd </span><span class="pun">.</span><span class="pln">\AdventureWorks</span><span class="pun">.</span><span class="typ">Context</span><span class="pln">\</span></code></pre>
                                    </li>
                                    <li class="task-list-item" id="taskIndex82">
                                        <p><label class="checkbox"><input type="checkbox"
                                                    aria-labelledby="taskIndex82"><span></span></label>Using the same
                                            terminal, import <strong>Microsoft.Azure.Cosmos</strong> from NuGet:</p>
                                        <pre><code class="prettyprint prettyprinted" tabindex="0" style=""><span class="pln">dotnet </span><span class="kwd">add</span><span class="pln"> </span><span class="kwd">package</span><span class="pln"> </span><span class="typ">Microsoft</span><span class="pun">.</span><span class="typ">Azure</span><span class="pun">.</span><span class="typ">Cosmos</span><span class="pln"> </span><span class="pun">--</span><span class="pln">version </span><span class="lit">3.4</span><span class="pun">.</span><span class="lit">1</span></code></pre>
                                        <blockquote>
                                            <p><strong>Note</strong>: The <strong>dotnet add package</strong> command
                                                will add the <strong>Microsoft.Azure.Cosmos</strong> package from
                                                <strong>NuGet</strong>. For more information, go to: <a
                                                    href="https://www.nuget.org/packages/Microsoft.Azure.Cosmos/3.4.1"
                                                    target="_blank">Microsoft.Azure.Cosmos</a>.</p>
                                        </blockquote>
                                    </li>
                                    <li class="task-list-item" id="taskIndex83">
                                        <p><label class="checkbox"><input type="checkbox"
                                                    aria-labelledby="taskIndex83"><span></span></label>Using the same
                                            terminal, build the ASP.NET web application project:</p>
                                        <pre><code class="prettyprint prettyprinted" tabindex="0" style=""><span class="pln">dotnet build</span></code></pre>
                                    </li>
                                    <li class="task-list-item" id="taskIndex84">
                                        <p><label class="checkbox"><input type="checkbox"
                                                    aria-labelledby="taskIndex84"><span></span></label>Close the current
                                            terminal.</p>
                                    </li>
                                </ol>
                                <h4 id="task-2-write-net-code-to-connect-to-azure-cosmos-db">Task 2: Write .NET code to
                                    connect to Azure Cosmos DB</h4>
                                <ol class="taskList">
                                    <li class="task-list-item" id="taskIndex85">
                                        <p><label class="checkbox"><input type="checkbox"
                                                    aria-labelledby="taskIndex85"><span></span></label>Create a new
                                            <strong>AdventureWorks.Context/AdventureWorksCosmosContext.cs</strong> file
                                            in Visual Studio Code.</p>
                                    </li>
                                    <li class="task-list-item" id="taskIndex86">
                                        <p><label class="checkbox"><input type="checkbox"
                                                    aria-labelledby="taskIndex86"><span></span></label>Add the following
                                            <strong>using</strong> directives for libraries that will be referenced by
                                            the application:</p>
                                        <pre><code class="prettyprint prettyprinted" tabindex="0" style=""><span class="kwd">using</span><span class="pln"> </span><span class="typ">AdventureWorks</span><span class="pun">.</span><span class="typ">Models</span><span class="pun">;</span><span class="pln">
</span><span class="kwd">using</span><span class="pln"> </span><span class="typ">Microsoft</span><span class="pun">.</span><span class="typ">Azure</span><span class="pun">.</span><span class="typ">Cosmos</span><span class="pun">;</span><span class="pln">
</span><span class="kwd">using</span><span class="pln"> </span><span class="typ">Microsoft</span><span class="pun">.</span><span class="typ">Azure</span><span class="pun">.</span><span class="typ">Cosmos</span><span class="pun">.</span><span class="typ">Linq</span><span class="pun">;</span><span class="pln">
</span><span class="kwd">using</span><span class="pln"> </span><span class="typ">System</span><span class="pun">;</span><span class="pln">
</span><span class="kwd">using</span><span class="pln"> </span><span class="typ">System</span><span class="pun">.</span><span class="typ">Collections</span><span class="pun">.</span><span class="typ">Generic</span><span class="pun">;</span><span class="pln">
</span><span class="kwd">using</span><span class="pln"> </span><span class="typ">System</span><span class="pun">.</span><span class="typ">Linq</span><span class="pun">;</span><span class="pln">
</span><span class="kwd">using</span><span class="pln"> </span><span class="typ">System</span><span class="pun">.</span><span class="typ">Threading</span><span class="pun">.</span><span class="typ">Tasks</span><span class="pun">;</span></code></pre>
                                    </li>
                                    <li class="task-list-item" id="taskIndex87">
                                        <p><label class="checkbox"><input type="checkbox"
                                                    aria-labelledby="taskIndex87"><span></span></label>Enter the
                                            following code to add an <strong>AdventureWorks.Context</strong> namespace
                                            block:</p>
                                        <pre><code class="prettyprint prettyprinted" tabindex="0" style=""><span class="kwd">namespace</span><span class="pln"> </span><span class="typ">AdventureWorks</span><span class="pun">.</span><span class="typ">Context</span><span class="pln">
</span><span class="pun">{</span><span class="pln">
</span><span class="pun">}</span></code></pre>
                                    </li>
                                    <li class="task-list-item" id="taskIndex88">
                                        <p><label class="checkbox"><input type="checkbox"
                                                    aria-labelledby="taskIndex88"><span></span></label>Create a new
                                            <strong>AdventureWorksCosmosContext</strong> class that implements the
                                            <strong>IAdventureWorksProductContext</strong> interface with a single
                                            read-only <em>Container</em> variable:</p>
                                        <pre><code class="prettyprint prettyprinted" tabindex="0" style=""><span class="kwd">public</span><span class="pln"> </span><span class="kwd">class</span><span class="pln"> </span><span class="typ">AdventureWorksCosmosContext</span><span class="pln"> </span><span class="pun">:</span><span class="pln"> </span><span class="typ">IAdventureWorksProductContext</span><span class="pln">
</span><span class="pun">{</span><span class="pln">
    </span><span class="kwd">private</span><span class="pln"> </span><span class="kwd">readonly</span><span class="pln"> </span><span class="typ">Container</span><span class="pln"> _container</span><span class="pun">;</span><span class="pln">
</span><span class="pun">}</span></code></pre>
                                    </li>
                                    <li class="task-list-item" id="taskIndex89">
                                        <p><label class="checkbox"><input type="checkbox"
                                                    aria-labelledby="taskIndex89"><span></span></label>Within the
                                            <strong>AdventureWorksCosmosContext</strong> class, add a new constructor
                                            that creates a new instance of the <strong>CosmosClient</strong> class, and
                                            then obtain both a <strong>Database</strong> and <strong>Container</strong>
                                            instance from the client:</p>
                                        <pre><code class="prettyprint prettyprinted" tabindex="0" style=""><span class="kwd">public</span><span class="pln"> </span><span class="typ">AdventureWorksCosmosContext</span><span class="pun">(</span><span class="kwd">string</span><span class="pln"> connectionString</span><span class="pun">,</span><span class="pln"> </span><span class="kwd">string</span><span class="pln"> database </span><span class="pun">=</span><span class="pln"> </span><span class="str">"Retail"</span><span class="pun">,</span><span class="pln"> </span><span class="kwd">string</span><span class="pln"> container </span><span class="pun">=</span><span class="pln"> </span><span class="str">"Online"</span><span class="pun">)</span><span class="pln">
</span><span class="pun">{</span><span class="pln">
    _container </span><span class="pun">=</span><span class="pln"> </span><span class="kwd">new</span><span class="pln"> </span><span class="typ">CosmosClient</span><span class="pun">(</span><span class="pln">connectionString</span><span class="pun">)</span><span class="pln">
        </span><span class="pun">.</span><span class="typ">GetDatabase</span><span class="pun">(</span><span class="pln">database</span><span class="pun">)</span><span class="pln">
        </span><span class="pun">.</span><span class="typ">GetContainer</span><span class="pun">(</span><span class="pln">container</span><span class="pun">);</span><span class="pln">
</span><span class="pun">}</span></code></pre>
                                    </li>
                                    <li class="task-list-item" id="taskIndex90">
                                        <p><label class="checkbox"><input type="checkbox"
                                                    aria-labelledby="taskIndex90"><span></span></label>Within the
                                            <strong>AdventureWorksCosmosContext</strong> class, add a new
                                            <strong>FindModelAsync</strong> method that creates a LINQ query, transforms
                                            it into an iterator, iterates over the result set, and then returns the
                                            single item in the result set:</p>
                                        <pre><code class="prettyprint prettyprinted" tabindex="0" style=""><span class="kwd">public</span><span class="pln"> </span><span class="kwd">async</span><span class="pln"> </span><span class="typ">Task</span><span class="pun">&lt;</span><span class="typ">Model</span><span class="pun">&gt;</span><span class="pln"> </span><span class="typ">FindModelAsync</span><span class="pun">(</span><span class="typ">Guid</span><span class="pln"> id</span><span class="pun">)</span><span class="pln">
</span><span class="pun">{</span><span class="pln">
    </span><span class="kwd">var</span><span class="pln"> iterator </span><span class="pun">=</span><span class="pln"> _container</span><span class="pun">.</span><span class="typ">GetItemLinqQueryable</span><span class="pun">&lt;</span><span class="typ">Model</span><span class="pun">&gt;()</span><span class="pln">
        </span><span class="pun">.</span><span class="typ">Where</span><span class="pun">(</span><span class="pln">m </span><span class="pun">=&gt;</span><span class="pln"> m</span><span class="pun">.</span><span class="pln">id </span><span class="pun">==</span><span class="pln"> id</span><span class="pun">)</span><span class="pln">
        </span><span class="pun">.</span><span class="typ">ToFeedIterator</span><span class="pun">&lt;</span><span class="typ">Model</span><span class="pun">&gt;();</span><pre><code><span class="typ">List</span><span class="pun">&amp;</span><span class="pln">lt</span><span class="pun">;</span><span class="typ">Model</span><span class="pun">&amp;</span><span class="pln">gt</span><span class="pun">;</span><span class="pln"> matches </span><span class="pun">=</span><span class="pln"> </span><span class="kwd">new</span><span class="pln"> </span><span class="typ">List</span><span class="pun">&amp;</span><span class="pln">lt</span><span class="pun">;</span><span class="typ">Model</span><span class="pun">&amp;</span><span class="pln">gt</span><span class="pun">;();</span><span class="pln">
</span><span class="kwd">while</span><span class="pln"> </span><span class="pun">(</span><span class="pln">iterator</span><span class="pun">.</span><span class="typ">HasMoreResults</span><span class="pun">)</span><span class="pln">
</span><span class="pun">{</span><span class="pln">
    </span><span class="kwd">var</span><span class="pln"> </span><span class="kwd">next</span><span class="pln"> </span><span class="pun">=</span><span class="pln"> </span><span class="kwd">await</span><span class="pln"> iterator</span><span class="pun">.</span><span class="typ">ReadNextAsync</span><span class="pun">();</span><span class="pln">
    matches</span><span class="pun">.</span><span class="typ">AddRange</span><span class="pun">(</span><span class="kwd">next</span><span class="pun">);</span><span class="pln">
</span><span class="pun">}</span><span class="pln">
</span><span class="kwd">return</span><span class="pln"> matches</span><span class="pun">.</span><span class="typ">SingleOrDefault</span><span class="pun">();</span><span class="pln">
</span></code></pre><span class="pun">}</span></code></pre>
                                    </li>
                                    <li class="task-list-item" id="taskIndex91">
                                        <p><label class="checkbox"><input type="checkbox"
                                                    aria-labelledby="taskIndex91"><span></span></label>Within the
                                            <strong>AdventureWorksCosmosContext</strong> class, add a new
                                            <strong>GetModelsAsync</strong> method that runs an SQL query, gets the
                                            query result iterator, iterates over the result set, and then returns the
                                            union of all results:</p>
                                        <pre><code class="prettyprint prettyprinted" tabindex="0" style=""><span class="kwd">public</span><span class="pln"> </span><span class="kwd">async</span><span class="pln"> </span><span class="typ">Task</span><span class="pun">&lt;</span><span class="typ">List</span><span class="pun">&lt;</span><span class="typ">Model</span><span class="pun">&gt;&gt;</span><span class="pln"> </span><span class="typ">GetModelsAsync</span><span class="pun">()</span><span class="pln">
</span><span class="pun">{</span><span class="pln">
    </span><span class="kwd">string</span><span class="pln"> query </span><span class="pun">=</span><span class="pln"> $@</span><span class="str">"SELECT * FROM items"</span><span class="pun">;</span><pre><code><span class="kwd">var</span><span class="pln"> iterator </span><span class="pun">=</span><span class="pln"> _container</span><span class="pun">.</span><span class="typ">GetItemQueryIterator</span><span class="pun">&amp;</span><span class="pln">lt</span><span class="pun">;</span><span class="typ">Model</span><span class="pun">&amp;</span><span class="pln">gt</span><span class="pun">;(</span><span class="pln">query</span><span class="pun">);</span><span class="pln">
</span><span class="typ">List</span><span class="pun">&amp;</span><span class="pln">lt</span><span class="pun">;</span><span class="typ">Model</span><span class="pun">&amp;</span><span class="pln">gt</span><span class="pun">;</span><span class="pln"> matches </span><span class="pun">=</span><span class="pln"> </span><span class="kwd">new</span><span class="pln"> </span><span class="typ">List</span><span class="pun">&amp;</span><span class="pln">lt</span><span class="pun">;</span><span class="typ">Model</span><span class="pun">&amp;</span><span class="pln">gt</span><span class="pun">;();</span><span class="pln">
</span><span class="kwd">while</span><span class="pln"> </span><span class="pun">(</span><span class="pln">iterator</span><span class="pun">.</span><span class="typ">HasMoreResults</span><span class="pun">)</span><span class="pln">
</span><span class="pun">{</span><span class="pln">
    </span><span class="kwd">var</span><span class="pln"> </span><span class="kwd">next</span><span class="pln"> </span><span class="pun">=</span><span class="pln"> </span><span class="kwd">await</span><span class="pln"> iterator</span><span class="pun">.</span><span class="typ">ReadNextAsync</span><span class="pun">();</span><span class="pln">
    matches</span><span class="pun">.</span><span class="typ">AddRange</span><span class="pun">(</span><span class="kwd">next</span><span class="pun">);</span><span class="pln">
</span><span class="pun">}</span><span class="pln">
</span><span class="kwd">return</span><span class="pln"> matches</span><span class="pun">;</span><span class="pln">
</span></code></pre><span class="pun">}</span></code></pre>
                                    </li>
                                    <li class="task-list-item" id="taskIndex92">
                                        <p><label class="checkbox"><input type="checkbox"
                                                    aria-labelledby="taskIndex92"><span></span></label>Within the
                                            <strong>AdventureWorksCosmosContext</strong> class, add a new
                                            <strong>FindProductAsync</strong> method that runs an SQL query, gets the
                                            query result iterator, iterates over the result set, and then returns the
                                            single item in the result set:</p>
                                        <pre><code class="prettyprint prettyprinted" tabindex="0" style=""><span class="kwd">public</span><span class="pln"> </span><span class="kwd">async</span><span class="pln"> </span><span class="typ">Task</span><span class="pun">&lt;</span><span class="typ">Product</span><span class="pun">&gt;</span><span class="pln"> </span><span class="typ">FindProductAsync</span><span class="pun">(</span><span class="typ">Guid</span><span class="pln"> id</span><span class="pun">)</span><span class="pln">
</span><span class="pun">{</span><span class="pln">
    </span><span class="kwd">string</span><span class="pln"> query </span><span class="pun">=</span><span class="pln"> $@</span><span class="str">"SELECT VALUE products
                        FROM models
                        JOIN products in models.Products
                        WHERE products.id = '{id}'"</span><span class="pun">;</span><pre><code><span class="kwd">var</span><span class="pln"> iterator </span><span class="pun">=</span><span class="pln"> _container</span><span class="pun">.</span><span class="typ">GetItemQueryIterator</span><span class="pun">&amp;</span><span class="pln">lt</span><span class="pun">;</span><span class="typ">Product</span><span class="pun">&amp;</span><span class="pln">gt</span><span class="pun">;(</span><span class="pln">query</span><span class="pun">);</span><span class="pln">
</span><span class="typ">List</span><span class="pun">&amp;</span><span class="pln">lt</span><span class="pun">;</span><span class="typ">Product</span><span class="pun">&amp;</span><span class="pln">gt</span><span class="pun">;</span><span class="pln"> matches </span><span class="pun">=</span><span class="pln"> </span><span class="kwd">new</span><span class="pln"> </span><span class="typ">List</span><span class="pun">&amp;</span><span class="pln">lt</span><span class="pun">;</span><span class="typ">Product</span><span class="pun">&amp;</span><span class="pln">gt</span><span class="pun">;();</span><span class="pln">
</span><span class="kwd">while</span><span class="pln"> </span><span class="pun">(</span><span class="pln">iterator</span><span class="pun">.</span><span class="typ">HasMoreResults</span><span class="pun">)</span><span class="pln">
</span><span class="pun">{</span><span class="pln">
    </span><span class="kwd">var</span><span class="pln"> </span><span class="kwd">next</span><span class="pln"> </span><span class="pun">=</span><span class="pln"> </span><span class="kwd">await</span><span class="pln"> iterator</span><span class="pun">.</span><span class="typ">ReadNextAsync</span><span class="pun">();</span><span class="pln">
    matches</span><span class="pun">.</span><span class="typ">AddRange</span><span class="pun">(</span><span class="kwd">next</span><span class="pun">);</span><span class="pln">
</span><span class="pun">}</span><span class="pln">
</span><span class="kwd">return</span><span class="pln"> matches</span><span class="pun">.</span><span class="typ">SingleOrDefault</span><span class="pun">();</span><span class="pln">
</span></code></pre><span class="pun">}</span></code></pre>
                                    </li>
                                    <li class="task-list-item" id="taskIndex93">
                                        <p><label class="checkbox"><input type="checkbox"
                                                    aria-labelledby="taskIndex93"><span></span></label>Save the
                                            <strong>AdventureWorksCosmosContext.cs</strong> file.</p>
                                    </li>
                                    <li class="task-list-item" id="taskIndex94">
                                        <p><label class="checkbox"><input type="checkbox"
                                                    aria-labelledby="taskIndex94"><span></span></label>Using a terminal,
                                            change your context to the <strong>AdventureWorks.Context</strong> folder:
                                        </p>
                                        <pre><code class="prettyprint prettyprinted" tabindex="0" style=""><span class="pln">cd </span><span class="pun">.</span><span class="pln">\AdventureWorks</span><span class="pun">.</span><span class="typ">Context</span><span class="pln">\</span></code></pre>
                                    </li>
                                    <li class="task-list-item" id="taskIndex95">
                                        <p><label class="checkbox"><input type="checkbox"
                                                    aria-labelledby="taskIndex95"><span></span></label>Using the same
                                            terminal, build the ASP.NET web application project:</p>
                                        <pre><code class="prettyprint prettyprinted" tabindex="0" style=""><span class="pln">dotnet build</span></code></pre>
                                        <blockquote>
                                            <p><strong>Note</strong>: If there are any build errors, review the
                                                <strong>AdventureWorksCosmosContext.cs</strong> file in the
                                                <strong>Allfiles
                                                    (F):\Allfiles\Labs\04\Solution\AdventureWorks\AdventureWorks.Context</strong>
                                                folder.</p>
                                        </blockquote>
                                    </li>
                                    <li class="task-list-item" id="taskIndex96">
                                        <p><label class="checkbox"><input type="checkbox"
                                                    aria-labelledby="taskIndex96"><span></span></label>Close the current
                                            terminal.</p>
                                    </li>
                                </ol>
                                <h4 id="task-3-update-the-azure-cosmos-db-connection-string">Task 3: Update the Azure
                                    Cosmos DB connection string</h4>
                                <ol class="taskList">
                                    <li class="task-list-item" id="taskIndex97">
                                        <p><label class="checkbox"><input type="checkbox"
                                                    aria-labelledby="taskIndex97"><span></span></label>Open the
                                            <strong>AdventureWorks.Web/appsettings.json</strong> file in Visual Studio
                                            Code.</p>
                                    </li>
                                    <li class="task-list-item" id="taskIndex98">
                                        <p><label class="checkbox"><input type="checkbox"
                                                    aria-labelledby="taskIndex98"><span></span></label>Replace the value
                                            of the <em>ConnectionStrings.AdventureWorksCosmosContext</em> property with
                                            the <strong>PRIMARY CONNECTION STRING</strong> of the Azure Cosmos DB
                                            account that you recorded earlier in this lab.</p>
                                    </li>
                                    <li class="task-list-item" id="taskIndex99">
                                        <p><label class="checkbox"><input type="checkbox"
                                                    aria-labelledby="taskIndex99"><span></span></label>Save the
                                            <strong>appsettings.json</strong> file.</p>
                                    </li>
                                </ol>
                                <h4 id="task-4-update-net-application-startup-logic">Task 4: Update .NET application
                                    startup logic</h4>
                                <ol class="taskList">
                                    <li class="task-list-item" id="taskIndex100">
                                        <p><label class="checkbox"><input type="checkbox"
                                                    aria-labelledby="taskIndex100"><span></span></label>Open the
                                            <strong>AdventureWorks.Web/Startup.cs</strong> file in Visual Studio Code.
                                        </p>
                                    </li>
                                    <li class="task-list-item" id="taskIndex101">
                                        <p><label class="checkbox"><input type="checkbox"
                                                    aria-labelledby="taskIndex101"><span></span></label>In the
                                            <strong>Startup</strong> class, find the existing
                                            <strong>ConfigureProductService</strong> method.</p>
                                        <blockquote>
                                            <p><strong>Note</strong>: The current product service uses SQL as its
                                                database.</p>
                                        </blockquote>
                                    </li>
                                    <li class="task-list-item" id="taskIndex102">
                                        <p><label class="checkbox"><input type="checkbox"
                                                    aria-labelledby="taskIndex102"><span></span></label>Replace the
                                            <strong>ConfigureProductService</strong> method with the following code:</p>
                                        <pre><code class="prettyprint prettyprinted" tabindex="0" style=""><span class="kwd">public</span><span class="pln"> </span><span class="kwd">void</span><span class="pln"> </span><span class="typ">ConfigureProductService</span><span class="pun">(</span><span class="typ">IServiceCollection</span><span class="pln"> services</span><span class="pun">)</span><span class="pln">
</span><span class="pun">{</span><span class="pln">
    services</span><span class="pun">.</span><span class="typ">AddScoped</span><span class="pun">&lt;</span><span class="typ">IAdventureWorksProductContext</span><span class="pun">,</span><span class="pln"> </span><span class="typ">AdventureWorksCosmosContext</span><span class="pun">&gt;(</span><span class="pln">provider </span><span class="pun">=&gt;</span><span class="pln">
            </span><span class="kwd">new</span><span class="pln"> </span><span class="typ">AdventureWorksCosmosContext</span><span class="pun">(</span><span class="pln">
                _configuration</span><span class="pun">.</span><span class="typ">GetConnectionString</span><span class="pun">(</span><span class="pln">nameof</span><span class="pun">(</span><span class="typ">AdventureWorksCosmosContext</span><span class="pun">))</span><span class="pln">
            </span><span class="pun">)</span><span class="pln">
    </span><span class="pun">);</span><span class="pln">
</span><span class="pun">}</span></code></pre>
                                    </li>
                                    <li class="task-list-item" id="taskIndex103">
                                        <p><label class="checkbox"><input type="checkbox"
                                                    aria-labelledby="taskIndex103"><span></span></label>Save the
                                            <strong>Startup.cs</strong> file.</p>
                                    </li>
                                </ol>
                                <h4
                                    id="task-5-validate-that-the-net-application-successfully-connects-to-azure-cosmos-db">
                                    Task 5: Validate that the .NET application successfully connects to Azure Cosmos DB
                                </h4>
                                <ol class="taskList">
                                    <li class="task-list-item" id="taskIndex104">
                                        <p><label class="checkbox"><input type="checkbox"
                                                    aria-labelledby="taskIndex104"><span></span></label>Using a
                                            terminal, change your context to the <strong>AdventureWorks.Web</strong>
                                            folder:</p>
                                        <pre><code class="prettyprint prettyprinted" tabindex="0" style=""><span class="pln">cd </span><span class="pun">.</span><span class="pln">\AdventureWorks</span><span class="pun">.</span><span class="typ">Web</span><span class="pln">\</span></code></pre>
                                    </li>
                                    <li class="task-list-item" id="taskIndex105">
                                        <p><label class="checkbox"><input type="checkbox"
                                                    aria-labelledby="taskIndex105"><span></span></label>Using the same
                                            terminal, run the ASP.NET web application project:</p>
                                        <pre><code class="prettyprint prettyprinted" tabindex="0" style=""><span class="pln">dotnet run</span></code></pre>
                                        <blockquote>
                                            <p><strong>Note</strong>: The <strong>dotnet run</strong> command will
                                                automatically build any changes to the project and then start the web
                                                application without a debugger attached. The command will output the URL
                                                of the running application and any assigned ports.</p>
                                        </blockquote>
                                    </li>
                                    <li class="task-list-item" id="taskIndex106">
                                        <p><label class="checkbox"><input type="checkbox"
                                                    aria-labelledby="taskIndex106"><span></span></label>Open the
                                            Microsoft Edge browser.</p>
                                    </li>
                                    <li class="task-list-item" id="taskIndex107">
                                        <p><label class="checkbox"><input type="checkbox"
                                                    aria-labelledby="taskIndex107"><span></span></label>In the open
                                            browser window, browse to the web application that's hosted at
                                            <strong>localhost</strong> on port <strong>5000</strong>.</p>
                                        <blockquote>
                                            <p><strong>Note</strong>: The URL is <a
                                                    href="http://localhost:5000/">http://localhost:5000</a>.</p>
                                        </blockquote>
                                    </li>
                                    <li class="task-list-item" id="taskIndex108">
                                        <p><label class="checkbox"><input type="checkbox"
                                                    aria-labelledby="taskIndex108"><span></span></label>In the web
                                            application, observe the list of models displayed from the front page.</p>
                                    </li>
                                    <li class="task-list-item" id="taskIndex109">
                                        <p><label class="checkbox"><input type="checkbox"
                                                    aria-labelledby="taskIndex109"><span></span></label>Find the
                                            <strong>Touring-1000</strong> model, and then select <strong>View
                                                Details</strong>.</p>
                                    </li>
                                    <li class="task-list-item" id="taskIndex110">
                                        <p><label class="checkbox"><input type="checkbox"
                                                    aria-labelledby="taskIndex110"><span></span></label>From the
                                            <strong>Touring-1000</strong> product detail page, perform the following
                                            actions:</p>
                                        <ol class="taskList">
                                            <li class="task-list-item" id="taskIndex111">
                                                <p><label class="checkbox"><input type="checkbox"
                                                            aria-labelledby="taskIndex111"><span></span></label>In the
                                                    <strong>Select options</strong> list, select <strong>Touring-1000
                                                        Yellow, 50, $2,384.07</strong>.</p>
                                            </li>
                                            <li class="task-list-item" id="taskIndex112">
                                                <p><label class="checkbox"><input type="checkbox"
                                                            aria-labelledby="taskIndex112"><span></span></label>Find
                                                    <strong>Add to Cart</strong>.</p>
                                            </li>
                                        </ol>
                                    </li>
                                    <li class="task-list-item" id="taskIndex113">
                                        <p><label class="checkbox"><input type="checkbox"
                                                    aria-labelledby="taskIndex113"><span></span></label>Close the
                                            browser window displaying your web application.</p>
                                    </li>
                                    <li class="task-list-item" id="taskIndex114">
                                        <p><label class="checkbox"><input type="checkbox"
                                                    aria-labelledby="taskIndex114"><span></span></label>Return to the
                                            <strong>Visual Studio Code</strong> window.</p>
                                    </li>
                                    <li class="task-list-item" id="taskIndex115">
                                        <p><label class="checkbox"><input type="checkbox"
                                                    aria-labelledby="taskIndex115"><span></span></label>Close the
                                            current terminal.</p>
                                    </li>
                                </ol>
                                <h4 id="review-4">Review</h4>
                                <p>In this exercise, you wrote C# code to query an Azure Cosmos DB collection by using
                                    the .NET SDK.</p>
                                <h3 id="exercise-6-clean-up-your-subscription">Exercise 6: Clean up your subscription
                                </h3>
                                <h4 id="task-1-open-azure-cloud-shell">Task 1: Open Azure Cloud Shell</h4>
                                <ol class="taskList">
                                    <li class="task-list-item" id="taskIndex116">
                                        <p><label class="checkbox"><input type="checkbox"
                                                    aria-labelledby="taskIndex116"><span></span></label>In the Azure
                                            portal, select the <strong>Cloud Shell</strong> icon to open a new shell
                                            instance.</p>
                                    </li>
                                    <li class="task-list-item" id="taskIndex117">
                                        <p><label class="checkbox"><input type="checkbox"
                                                    aria-labelledby="taskIndex117"><span></span></label>If Cloud Shell
                                            isn't already configured, configure the shell for Bash by using the default
                                            settings.</p>
                                    </li>
                                </ol>
                                <h4 id="task-2-delete-resource-groups">Task 2: Delete resource groups</h4>
                                <ol class="taskList">
                                    <li class="task-list-item" id="taskIndex118">
                                        <p><label class="checkbox"><input type="checkbox"
                                                    aria-labelledby="taskIndex118"><span></span></label>Enter the
                                            following command, and then select Enter to delete the
                                            <strong>PolyglotData</strong> resource group:</p>
                                        <pre><code class="prettyprint prettyprinted" tabindex="0" style=""><span class="pln">az </span><span class="kwd">group</span><span class="pln"> </span><span class="kwd">delete</span><span class="pln"> </span><span class="pun">--</span><span class="pln">name </span><span class="typ">PolyglotData</span><span class="pln"> </span><span class="pun">--</span><span class="kwd">no</span><span class="pun">-</span><span class="pln">wait </span><span class="pun">--</span><span class="pln">yes</span></code></pre>
                                    </li>
                                    <li class="task-list-item" id="taskIndex119">
                                        <p><label class="checkbox"><input type="checkbox"
                                                    aria-labelledby="taskIndex119"><span></span></label>Close the Cloud
                                            Shell pane in the portal.</p>
                                    </li>
                                </ol>
                                <h4 id="task-3-close-the-active-applications">Task 3: Close the active applications</h4>
                                <ol class="taskList">
                                    <li class="task-list-item" id="taskIndex120">
                                        <p><label class="checkbox"><input type="checkbox"
                                                    aria-labelledby="taskIndex120"><span></span></label>Close the
                                            currently running Microsoft Edge application.</p>
                                    </li>
                                    <li class="task-list-item" id="taskIndex121">
                                        <p><label class="checkbox"><input type="checkbox"
                                                    aria-labelledby="taskIndex121"><span></span></label>Close the
                                            currently running Visual Studio Code application.</p>
                                    </li>
                                </ol>
                                <h4 id="review-5">Review</h4>
                                <p>In this exercise, you cleaned up your subscription by removing the resource groups
                                    used in this lab.</p>
                            </include>
                            <hr>
                            <h3 id="congratulations">Congratulations!</h3>
                            <p>You have successfully completed this exercise. Click <strong>End</strong> to advance to
                                the next exercise.</p>
                        </div>
                    </div>
                </div>
            </div>
        </div>
    </div>
    <textarea id="copyInput" style="position: absolute; left:-10000px; top:-10000px; display:none;"></textarea>
    <style id="design-studio-animate">
        .designstudio-animated {
            -webkit-animation-duration: .5s;
            animation-duration: .5s;
            -webkit-animation-fill-mode: both;
            animation-fill-mode: both;
        }

        @keyframes designstudio-fadeOut {
            from {
                opacity: 1;
            }

            to {
                opacity: 0;
            }
        }

        .designstudio-fadeOut {
            animation-name: designstudio-fadeOut;
        }

        @-webkit-keyframes designstudio-fadeInUp {
            from {
                opacity: 0;
                -webkit-transform: translate3d(0, 100%, 0);
                transform: translate3d(0, 100%, 0);
            }

            to {
                opacity: 1;
                -webkit-transform: none;
                transform: none;
            }
        }

        @keyframes designstudio-fadeInUp {
            from {
                opacity: 0;
                -webkit-transform: translate3d(0, 100%, 0);
                transform: translate3d(0, 100%, 0);
            }

            to {
                opacity: 1;
                -webkit-transform: none;
                transform: none;
            }
        }

        .designstudio-fadeInUp {
            -webkit-animation-name: designstudio-fadeInUp;
            animation-name: designstudio-fadeInUp;
        }

        @-webkit-keyframes designstudio-fadeInDown {
            from {
                opacity: 0;
                -webkit-transform: translate3d(0, -100%, 0);
                transform: translate3d(0, -100%, 0);
            }

            to {
                opacity: 1;
                -webkit-transform: none;
                transform: none;
            }
        }

        @keyframes designstudio-fadeInDown {
            from {
                opacity: 0;
                -webkit-transform: translate3d(0, -100%, 0);
                transform: translate3d(0, -100%, 0);
            }

            to {
                opacity: 1;
                -webkit-transform: none;
                transform: none;
            }
        }

        .designstudio-fadeInDown {
            -webkit-animation-name: designstudio-fadeInDown;
            animation-name: designstudio-fadeInDown;
        }

        @-webkit-keyframes designstudio-fadeInLeft {
            from {
                opacity: 0;
                -webkit-transform: translate3d(-100%, 0, 0);
                transform: translate3d(-100%, 0, 0);
            }

            to {
                opacity: 1;
                -webkit-transform: none;
                transform: none;
            }
        }

        @keyframes designstudio-fadeInLeft {
            from {
                opacity: 0;
                -webkit-transform: translate3d(-100%, 0, 0);
                transform: translate3d(-100%, 0, 0);
            }

            to {
                opacity: 1;
                -webkit-transform: none;
                transform: none;
            }
        }

        .designstudio-fadeInLeft {
            -webkit-animation-name: designstudio-fadeInLeft;
            animation-name: designstudio-fadeInLeft;
        }

        @-webkit-keyframes designstudio-fadeInRight {
            from {
                opacity: 0;
                -webkit-transform: translate3d(100%, 0, 0);
                transform: translate3d(100%, 0, 0);
            }

            to {
                opacity: 1;
                -webkit-transform: none;
                transform: none;
            }
        }

        @keyframes designstudio-fadeInRight {
            from {
                opacity: 0;
                -webkit-transform: translate3d(100%, 0, 0);
                transform: translate3d(100%, 0, 0);
            }

            to {
                opacity: 1;
                -webkit-transform: none;
                transform: none;
            }
        }

        .designstudio-fadeInRight {
            -webkit-animation-name: designstudio-fadeInRight;
            animation-name: designstudio-fadeInRight;
        }

        @-webkit-keyframes designstudio-fadeOutUp {
            from {
                opacity: 1;
            }

            to {
                opacity: 0;
                -webkit-transform: translate3d(0, -100%, 0);
                transform: translate3d(0, -100%, 0);
            }
        }

        @keyframes designstudio-fadeOutUp {
            from {
                opacity: 1;
            }

            to {
                opacity: 0;
                -webkit-transform: translate3d(0, -100%, 0);
                transform: translate3d(0, -100%, 0);
            }
        }

        .designstudio-fadeOutUp {
            -webkit-animation-name: designstudio-fadeOutUp;
            animation-name: designstudio-fadeOutUp;
        }

        @-webkit-keyframes designstudio-fadeOutDown {
            from {
                opacity: 1;
            }

            to {
                opacity: 0;
                -webkit-transform: translate3d(0, 100%, 0);
                transform: translate3d(0, 100%, 0);
            }
        }

        @keyframes designstudio-fadeOutDown {
            from {
                opacity: 1;
            }

            to {
                opacity: 0;
                -webkit-transform: translate3d(0, 100%, 0);
                transform: translate3d(0, 100%, 0);
            }
        }

        .designstudio-fadeOutDown {
            -webkit-animation-name: designstudio-fadeOutDown;
            animation-name: designstudio-fadeOutDown;
        }

        @-webkit-keyframes designstudio-fadeOutLeft {
            from {
                opacity: 1;
            }

            to {
                opacity: 0;
                -webkit-transform: translate3d(-100%, 0, 0);
                transform: translate3d(-100%, 0, 0);
            }
        }

        @keyframes designstudio-fadeOutLeft {
            from {
                opacity: 1;
            }

            to {
                opacity: 0;
                -webkit-transform: translate3d(-100%, 0, 0);
                transform: translate3d(-100%, 0, 0);
            }
        }

        .designstudio-fadeOutLeft {
            -webkit-animation-name: designstudio-fadeOutLeft;
            animation-name: designstudio-fadeOutLeft;
        }

        @-webkit-keyframes designstudio-fadeOutRight {
            from {
                opacity: 1;
            }

            to {
                opacity: 0;
                -webkit-transform: translate3d(100%, 0, 0);
                transform: translate3d(100%, 0, 0);
            }
        }

        @keyframes designstudio-fadeOutRight {
            from {
                opacity: 1;
            }

            to {
                opacity: 0;
                -webkit-transform: translate3d(100%, 0, 0);
                transform: translate3d(100%, 0, 0);
            }
        }

        .designstudio-fadeOutRight {
            -webkit-animation-name: designstudio-fadeOutRight;
            animation-name: designstudio-fadeOutRight;
        }

        @-webkit-keyframes designstudio-slideInDown {
            from {
                -webkit-transform: translate3d(0, -100%, 0);
                transform: translate3d(0, -100%, 0);
                visibility: visible;
            }

            to {
                -webkit-transform: translate3d(0, 0, 0);
                transform: translate3d(0, 0, 0);
            }
        }

        @keyframes designstudio-slideInDown {
            from {
                -webkit-transform: translate3d(0, -100%, 0);
                transform: translate3d(0, -100%, 0);
                visibility: visible;
            }

            to {
                -webkit-transform: translate3d(0, 0, 0);
                transform: translate3d(0, 0, 0);
            }
        }

        .designstudio-slideInDown {
            -webkit-animation-name: designstudio-slideInDown;
            animation-name: designstudio-slideInDown;
        }

        @-webkit-keyframes designstudio-slideInLeft {
            from {
                -webkit-transform: translate3d(-100%, 0, 0);
                transform: translate3d(-100%, 0, 0);
                visibility: visible;
            }

            to {
                -webkit-transform: translate3d(0, 0, 0);
                transform: translate3d(0, 0, 0);
            }
        }

        @keyframes designstudio-slideInLeft {
            from {
                -webkit-transform: translate3d(-100%, 0, 0);
                transform: translate3d(-100%, 0, 0);
                visibility: visible;
            }

            to {
                -webkit-transform: translate3d(0, 0, 0);
                transform: translate3d(0, 0, 0);
            }
        }

        .designstudio-slideInLeft {
            -webkit-animation-name: designstudio-slideInLeft;
            animation-name: designstudio-slideInLeft;
        }

        @-webkit-keyframes designstudio-slideInRight {
            from {
                -webkit-transform: translate3d(100%, 0, 0);
                transform: translate3d(100%, 0, 0);
                visibility: visible;
            }

            to {
                -webkit-transform: translate3d(0, 0, 0);
                transform: translate3d(0, 0, 0);
            }
        }

        @keyframes designstudio-slideInRight {
            from {
                -webkit-transform: translate3d(100%, 0, 0);
                transform: translate3d(100%, 0, 0);
                visibility: visible;
            }

            to {
                -webkit-transform: translate3d(0, 0, 0);
                transform: translate3d(0, 0, 0);
            }
        }

        .designstudio-slideInRight {
            -webkit-animation-name: designstudio-slideInRight;
            animation-name: designstudio-slideInRight;
        }

        @-webkit-keyframes designstudio-slideInUp {
            from {
                -webkit-transform: translate3d(0, 100%, 0);
                transform: translate3d(0, 100%, 0);
                visibility: visible;
            }

            to {
                -webkit-transform: translate3d(0, 0, 0);
                transform: translate3d(0, 0, 0);
            }
        }

        @keyframes designstudio-slideInUp {
            from {
                -webkit-transform: translate3d(0, 100%, 0);
                transform: translate3d(0, 100%, 0);
                visibility: visible;
            }

            to {
                -webkit-transform: translate3d(0, 0, 0);
                transform: translate3d(0, 0, 0);
            }
        }

        .designstudio-slideInUp {
            -webkit-animation-name: designstudio-slideInUp;
            animation-name: designstudio-slideInUp;
        }

        .designstudio-button:focus {
            outline: 2px solid #757575;
        }
    </style>
</body>

</html>